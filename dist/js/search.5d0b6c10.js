(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["search"],{"0b14":function(t,e,s){"use strict";var r=s("4ebc"),i=s.n(r);i.a},"214f":function(t,e,s){"use strict";s("b0c5");var r=s("2aba"),i=s("32e9"),n=s("79e5"),a=s("be13"),o=s("2b4c"),c=s("520a"),l=o("species"),u=!n((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var s="ab".split(t);return 2===s.length&&"a"===s[0]&&"b"===s[1]}();t.exports=function(t,e,s){var p=o(t),g=!n((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),d=g?!n((function(){var e=!1,s=/a/;return s.exec=function(){return e=!0,null},"split"===t&&(s.constructor={},s.constructor[l]=function(){return s}),s[p](""),!e})):void 0;if(!g||!d||"replace"===t&&!u||"split"===t&&!h){var f=/./[p],m=s(a,p,""[t],(function(t,e,s,r,i){return e.exec===c?g&&!i?{done:!0,value:f.call(e,s,r)}:{done:!0,value:t.call(s,e,r)}:{done:!1}})),b=m[0],v=m[1];r(String.prototype,t,b),i(RegExp.prototype,p,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},"23c6":function(t,e,s){var r=s("2d95"),i=s("2b4c")("toStringTag"),n="Arguments"==r(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(s){}};t.exports=function(t){var e,s,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(s=a(e=Object(t),i))?s:n?r(e):"Object"==(o=r(e))&&"function"==typeof e.callee?"Arguments":o}},2941:function(t,e,s){},"2e5e":function(t,e,s){},"386d":function(t,e,s){"use strict";var r=s("cb7c"),i=s("83a1"),n=s("5f1b");s("214f")("search",1,(function(t,e,s,a){return[function(s){var r=t(this),i=void 0==s?void 0:s[e];return void 0!==i?i.call(s,r):new RegExp(s)[e](String(r))},function(t){var e=a(s,t,this);if(e.done)return e.value;var o=r(t),c=String(this),l=o.lastIndex;i(l,0)||(o.lastIndex=0);var u=n(o,c);return i(o.lastIndex,l)||(o.lastIndex=l),null===u?-1:u.index}]}))},"4d67":function(t,e,s){},"4ebc":function(t,e,s){},"512b":function(t,e,s){"use strict";var r=s("e1d2");class i{static singer(){return Object(r["a"])("artist",{})}static getSingerDetail(t){return Object(r["a"])("singerDetail",{params:{id:t}})}}e["a"]=i},"520a":function(t,e,s){"use strict";var r=s("0bfb"),i=RegExp.prototype.exec,n=String.prototype.replace,a=i,o="lastIndex",c=function(){var t=/a/,e=/b*/g;return i.call(t,"a"),i.call(e,"a"),0!==t[o]||0!==e[o]}(),l=void 0!==/()??/.exec("")[1],u=c||l;u&&(a=function(t){var e,s,a,u,h=this;return l&&(s=new RegExp("^"+h.source+"$(?!\\s)",r.call(h))),c&&(e=h[o]),a=i.call(h,t),c&&a&&(h[o]=h.global?a.index+a[0].length:e),l&&a&&a.length>1&&n.call(a[0],s,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(a[u]=void 0)})),a}),t.exports=a},"5f1b":function(t,e,s){"use strict";var r=s("23c6"),i=RegExp.prototype.exec;t.exports=function(t,e){var s=t.exec;if("function"===typeof s){var n=s.call(t,e);if("object"!==typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},7978:function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"slide"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"pop-menu",on:{click:[t.hide,function(t){t.stopPropagation()}]}},[s("div",{staticClass:"list-wrapper",on:{click:function(t){t.stopPropagation()}}},[s("Scroll",{ref:"listContent",staticClass:"list-content",attrs:{data:t.scrollData}},[s("div",{staticClass:"item-wrapper"},[s("div",{staticClass:"header  item border-bottom",on:{click:t.play}},[t._v("歌曲："+t._s(t.song.name))]),s("div",{staticClass:"next-play item border-bottom",on:{click:t.playNext}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-play-circle"}})]),t._v("下一首播放\n          ")]),s("div",{staticClass:"like item border-bottom",on:{click:function(e){return t.toggleFavorite(t.song)}}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":t.getFavoriteIcon(t.song)}})]),t._v("喜欢\n          ")]),s("div",{staticClass:"singer item border-bottom",on:{click:function(e){return t.toSinger(t.song)}}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-user"}})]),t._v("歌手："+t._s(t.song.singer)+"\n          ")]),s("div",{staticClass:"singer item border-bottom"},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-album"}})]),t._v("专辑："+t._s(t.song.album)+"\n          ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDelete,expression:"showDelete"}],staticClass:"delete item border-bottom",on:{click:function(e){return t.deleteOne(t.song)}}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-close"}})]),t._v("删除\n          ")])])])],1)])])},i=[],n=(s("ac6a"),s("ade3")),a=s("3ce5"),o=s("0712"),c=s("5880");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var h={name:"popMenu",components:{Scroll:a["a"]},mixins:[o["a"]],props:{showDelete:{type:Boolean,default:!1}},data(){return{isShow:!1,song:[]}},computed:{scrollData(){let t=[this.song];return t}},watch:{},methods:u({},Object(c["mapActions"])(["setTips"]),{show(t){this.isShow=!0,this.song=t},hide(){this.isShow=!1},playNext(){this.$emit("nextPlay",this.song),this.setTips("已经将一首歌曲添加到播放队列")},play(){this.$emit("playNow",this.song)},deleteOne(t){this.hide(),this.$emit("deleteOne",t),this.setTips("已经删除一首歌曲啦")}})},p=h,g=(s("aaee"),s("2877")),d=Object(g["a"])(p,r,i,!1,null,"1010f241",null);e["a"]=d.exports},"79ce":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search"},[s("search-bar",{ref:"searchbar"}),s("Scroll",{ref:"list",staticClass:"shortcut",attrs:{data:t.shortCut}},[s("div",[s("h3",{staticClass:"title"},[t._v("热门搜索")]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.query,expression:"!query"}],staticClass:"hots border-bottom"},t._l(t.hots,(function(e){return s("div",{key:e.first,staticClass:"hot",on:{click:function(s){return t.setQuery(e.first)}}},[t._v("\n          "+t._s(e.first)+"\n        ")])})),0),s("History",{directives:[{name:"show",rawName:"v-show",value:!t.query&&t.searchHistory&&t.searchHistory.length>0,expression:"!query && searchHistory && searchHistory.length > 0"}],on:{selectItem:t.setQuery,deleteOne:t.deleteSearchHistory,deleteAll:t.showConfirm}})],1)]),s("Suggest",{directives:[{name:"show",rawName:"v-show",value:t.query,expression:"query"}],on:{handleAlbum:t.getAlbum,handleSinger:t.getSinger,handleSong:t.setSong}}),s("transition",{attrs:{name:"slide-left"}},[s("router-view",{ref:"musicList",attrs:{title:t.title,songs:t.songsList,picUrl:t.picUrl,id:t.id},on:{select:t.selectItem}})],1),s("Confirm",{ref:"confirm",attrs:{text:"确定要清空所有搜索历史吗"},on:{deleteAll:t.deleteAllSearchHistory}})],1)},i=[],n=(s("ac6a"),s("ade3")),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-bar"},[s("svg",{staticClass:"icon back",attrs:{"aria-hidden":"true"},on:{click:function(e){return e.stopPropagation(),t.hideSearch(e)}}},[s("use",{attrs:{"xlink:href":"#icon-left"}})]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.queryArg,expression:"queryArg"}],ref:"input",staticClass:"input",attrs:{placeholder:t.placeholder,type:"text",autofocus:""},domProps:{value:t.queryArg},on:{input:function(e){e.target.composing||(t.queryArg=e.target.value)}}}),t.query?s("svg",{staticClass:"icon souso",attrs:{"aria-hidden":"true"},on:{click:t.deleteQuery}},[s("use",{attrs:{"xlink:href":"#icon-close"}})]):s("svg",{staticClass:"icon souso",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-sousuo"}})])])},o=[],c=s("5880");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var h={name:"",components:{},props:{placeholder:{type:String,default:"搜歌手，搜歌曲"}},data(){return{queryArg:""}},computed:u({},Object(c["mapGetters"])(["showFooter","query"])),created(){this.$watch("queryArg",t=>{this.setQuery(t)}),this.$watch("query",t=>{this.queryArg=t})},methods:u({},Object(c["mapMutations"])({setShowSearch:"SET_SHOW_SEARCH",setQuery:"SET_QUERY",setShowFooter:"SET_SHOW_FOOTER"}),{hideSearch(){this.setQuery(""),this.$router.go(-1)},deleteQuery(){this.setQuery("")}})},p=h,g=(s("0b14"),s("2877")),d=Object(g["a"])(p,a,o,!1,null,"307ca89c",null),f=d.exports,m=s("e1d2");class b{static getHotSearch(){return Object(m["a"])("hotSearch")}static getSuggest(t){return Object(m["a"])("suggest",{params:{keywords:t}})}static getAlbumDetail(t){return Object(m["a"])("album",{params:{id:t}})}}var v=b,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"suggest"},[s("Scroll",{ref:"list",staticClass:"scroll-wrapper",attrs:{data:t.allData}},[s("div",{staticClass:"list-detail"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.album&&t.album.length>0,expression:"album && album.length > 0"}],staticClass:"album"},[s("ul",{staticClass:"list"},[s("h3",{staticClass:"title"},[t._v("专辑")]),t._l(t.album,(function(e){return s("li",{key:e.albumId,staticClass:"item border-bottom",on:{click:function(s){return t.selectAlbum(e)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.picUrl,expression:"item.picUrl"}],staticClass:"img",attrs:{alt:""}}),s("div",{staticClass:"right"},[s("div",{staticClass:"name"},[t._v("专辑："+t._s(e.name))]),s("div",{staticClass:"singer"},[t._v(t._s(e.singer))])])])}))],2)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.artists&&t.artists.length>0,expression:"artists && artists.length > 0"}],staticClass:"artists"},[s("ul",{staticClass:"list"},[s("h3",{staticClass:"title"},[t._v("歌手")]),t._l(t.artists,(function(e){return s("li",{key:e.id,staticClass:"item border-bottom",on:{click:function(s){return t.selectSinger(e)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.picUrl,expression:"item.picUrl"}],staticClass:"img",attrs:{alt:""}}),s("div",{staticClass:"singer"},[t._v("歌手："+t._s(e.singer))])])}))],2)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.songs&&t.songs.length>0,expression:"songs && songs.length > 0"}],staticClass:"songs"},[s("ul",{ref:"wrapper",staticClass:"song-list"},[s("h3",{staticClass:"title"},[t._v("歌曲")]),t._l(t.songs,(function(e,r){return s("li",{key:e.id,staticClass:"song border-bottom",on:{click:function(s){return t.selectSong(e)}}},[s("div",{staticClass:"number"},[t._v(t._s(r+1))]),s("div",{staticClass:"right"},[s("div",{staticClass:"name"},[t._v(t._s(e.name))]),s("div",{staticClass:"singer"},[t._v("\n                "+t._s(e.singer)+"\n                "),s("span",{staticClass:"album"},[t._v("-"+t._s(e.album))])])]),s("svg",{staticClass:"icon i-switch",attrs:{"aria-hidden":"true"},on:{click:function(s){return s.stopPropagation(),t.showPopOver(e)}}},[s("use",{attrs:{"xlink:href":"#icon-switch"}})])])}))],2),s("pop-menu",{ref:"popMenu",on:{nextPlay:t.nextPlay,playNow:t.nowPlay}})],1)])])],1)},O=[],w=(s("386d"),s("3ce5")),S=s("0712"),j=s("7978");function x(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function C(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?x(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):x(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var P={name:"",components:{Scroll:w["a"],PopMenu:j["a"]},mixins:[S["b"],S["c"]],props:{},data(){return{page:1,album:[],artists:[],songs:[]}},computed:C({},Object(c["mapGetters"])(["query"]),{allData(){return this.album.concat(this.artists,this.songs)}}),watch:{query(t){""!==t&&this.search(t)}},created(){},mounted(){},methods:{selectAlbum(t){this.$emit("handleAlbum",t)},selectSinger(t){this.$emit("handleSinger",t)},selectSong(t){this.$emit("handleSong",t)},search(t){v.getSuggest(t).then(t=>{let e,s=t.result;e=s.albums&&s.albums[0].artist.picUrl?s.albums[0].artist.picUrl:"https://ws2.sinaimg.cn/large/006tNbRwly1fy54tapw58j30yl0u0h16.jpg",s.albums&&s.albums.length>0&&this.setAlbum(s.albums),s.artists&&s.artists.length>0&&this.setArtist(s.artists),s.songs&&s.songs.length>0&&this.setSongs(s.songs,e)})},setAlbum(t){this.album=[],t.forEach(t=>{let e=t.id,s=t.name,r=t.artist.name,i=t.artist.picUrl;this.album.push({id:e,name:s,singer:r,picUrl:i})})},setArtist(t){this.artists=[],t.forEach(t=>{let e=t.id,s=t.name,r=t.picUrl;this.artists.push({id:e,singer:s,picUrl:r})})},setSongs(t,e){this.songs=[],t.forEach(t=>{let s=t.id,r=t.name,i=t.artists[0].name,n=t.album.name;this.songs.push({id:s,name:r,singer:i,picUrl:e,album:n})})}}},_=P,k=(s("d9ee"),Object(g["a"])(_,y,O,!1,null,"68797ec6",null)),D=k.exports,E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"history"},[s("h3",{staticClass:"title"},[t._v("搜索历史")]),s("p",{staticClass:"delete",on:{click:function(e){return e.stopPropagation(),t.deleteAll(e)}}},[t._v("清空历史")]),s("transition-group",{staticClass:"list",attrs:{tag:"ul",name:"list"}},t._l(t.searchHistory,(function(e){return s("li",{key:e,staticClass:"item border-bottom",on:{click:function(s){return t.selectItem(e)}}},[s("span",{staticClass:"text"},[t._v(t._s(e))]),s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"},on:{click:function(s){return s.stopPropagation(),t.deleteHistoryItem(e)}}},[s("use",{attrs:{"xlink:href":"#icon-close"}})])])})),0)],1)},A=[];function H(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function q(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?H(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):H(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var $={name:"",computed:q({},Object(c["mapGetters"])(["searchHistory"])),created(){},mounted(){},methods:{deleteHistoryItem(t){this.$emit("deleteOne",t)},selectItem(t){this.$emit("selectItem",t)},deleteAll(){this.$emit("deleteAll")}}},N=$,U=(s("ffce"),Object(g["a"])(N,E,A,!1,null,"3b29778d",null)),I=U.exports,R=s("512b"),T=s("ed08"),Q=s("a32c");function z(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function F(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?z(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):z(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var M={name:"Search",components:{SearchBar:f,Suggest:D,History:I,Confirm:Q["a"],Scroll:w["a"]},mixins:[S["b"]],props:{},data(){return{hots:[],songsList:[],list:{}}},computed:F({},Object(c["mapGetters"])(["query","searchHistory"]),{title(){return this.list.name},picUrl(){return this.list.picUrl},id(){return this.list.id},shortCut(){return this.hots.concat(this.searchHistory)}}),watch:{query(t){t||setTimeout(()=>{this.$refs.list.refresh()},20)}},created(){v.getHotSearch().then(t=>{this.hots=t.result.hots})},methods:F({},Object(c["mapMutations"])({setQuery:"SET_QUERY"}),{},Object(c["mapActions"])(["randomPlay","insertSong","insertSongNext","saveSearchHistory","deleteSearchHistory","deleteAllSearchHistory"]),{showConfirm(){this.$refs.confirm.show()},getAlbumDetail(t){v.getAlbumDetail(t).then(e=>{let s=e.songs;this.setDetail(s,t)})},getDeatil(t){R["a"].getSingerDetail(t).then(e=>{let s=e.hotSongs;this.setDetail(s,t)})},setDetail(t,e){this.songsList=this.normalizeSongs(t),e&&this.$router.push({path:`/search/${e}`})},normalizeSongs(t){let e=[];return t.forEach(t=>{e.push(Object(T["c"])(t))}),e},getAlbum(t){this.saveSearchHistory(this.query),this.list=t;let e=t.id;this.getAlbumDetail(e)},getSinger(t){this.saveSearchHistory(this.query),this.list=t;let e=t.id;this.getDeatil(e)},setSong(t){this.saveSearchHistory(this.query),this.insertSong(t)},selectItem(t){this.insertSong(t)}})},G=M,L=(s("d4a6"),Object(g["a"])(G,r,i,!1,null,"5f67497f",null));e["default"]=L.exports},"7e29":function(t,e,s){},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},aaee:function(t,e,s){"use strict";var r=s("2941"),i=s.n(r);i.a},b0c5:function(t,e,s){"use strict";var r=s("520a");s("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},d4a6:function(t,e,s){"use strict";var r=s("2e5e"),i=s.n(r);i.a},d9ee:function(t,e,s){"use strict";var r=s("7e29"),i=s.n(r);i.a},ffce:function(t,e,s){"use strict";var r=s("4d67"),i=s.n(r);i.a}}]);
//# sourceMappingURL=search.5d0b6c10.js.map